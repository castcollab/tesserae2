language: python
python:
- '3.5'
- '3.6'
cache:
  directories:
  - ".cache"
  - libs
os:
- linux
addons:
  apt:
    packages:
    - liblzma-dev
    - libbz2-dev
install: make init
script: BIN_DIR=./bin make test HYPOTHESIS_PROFILE=ci
after_success:
- make lint
- coveralls
jobs:
  include:
  - stage: deploy to pypi
    python: '3.6'
    deploy:
      provider: pypi
      user: wkretzsch
      password:
        secure: i70l7Iy0zeBx/4DwIIcnf4ZxN+/SNfos3f6dcUZN2G7T//cRg0wseiBpsed4Ti4gDAzftAucnxvfl1v1hvZ/toMjF4iqNAxsP6ABzannS+LSCe4iAv1cAVSAPQU3YV6cCKCPevyysVNg0pUtQcsD2XHVCe4igwhkqN+GEkk9QMglie4ippsTszFaLC9nB2MNE19iaUPSlQ6uL7LA+qXsfarHQoNGFAQ5r18yiY9ovEJgE4Xk0ee1N4vHnkRxxAgqY9E/vEkpSzokXV4ADIBEB+Ln+Rv3J/XpfwXY1muR6nQCRIhQtGJRnKU5yna3CVqe1iXY5cHLEwx+57vZPb8BV+WboJouWX7wwS5/+ixo4NGoGzIHaqaN3kiHvdhqaGuUfLumNaJBYHZq2GJZoMrvh6QlytSYhhBdE+MlVE+rwed03zhY3hRHQ98wvUJ47asoUwZ0Tp9SqNpi5R65zFABL3ojGMf8FvNKXOGPr9OxNb35WUvUWRSsknVfsPVJFh7P+QuH6elb/XZQMZYQOanbBksM4GN1pl+Tf3G5MGRQOcNKZcjis3wSOvBT8oiW5lcsFeHFr1EjEWCspOkYInjjzWUxAe+GLXnXBpXtOL7ZrDL+7B8oILRdJDuOdmoxsIreVXcTS15BsfwErGnWKWBF3gJ6q5XREO2viKzxn/xltl8=
      on:
        tags: true
